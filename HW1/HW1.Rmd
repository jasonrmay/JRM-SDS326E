---
title: "HW1"
output: html_document
author: Jason R. May
---

```{R}
library(tidyverse)
```

# Question 1.A
```{r}
  # part a
  college <- read.csv("Data/College.csv")
```

This reads in the college csv into a table. 

# Question 1.B
```{r}
  rownames(college) <- college[, 1]
  View(college)
  college <- college[, -1]
  view(college)
```

First we set the table index to the first column (college names). Secondly, we select all rows and columns **EXCEPT COLUMN 1**.

# Question 1.C.i
```{r}
  summary(college)
```

This provides us the 5 number summary and the mean of each column in our table.

# Question 1.C.ii
```{r}
  pairs(college[,2:11])
```

The produces a scatter plot of each variable with every other variable, though here we subsetted the data to only the 2nd to the 11th columns/variables.

# Question 1.C.iii
```{r}
  college |> 
    ggplot(aes(x = Private, y = Outstate)) +
    geom_boxplot() +
    labs(title = "Out-of-State Tuition vs Private College",
         x = "Private College",
         y = "Out-of-State tuintion") +
    theme_bw()
```

This grouped boxplot of out of state tuition grouped by private status shows the median out of state tuition is significantly higher for private colleges. In fact, all statistics in the five number summary, except the minimum, is higher for private colleges in terms of out of state tuition.

# Question 1.C.iv
```{r}
  Elite <- rep("No", nrow(college))
  Elite[college$Top10perc > 50] <- "Yes"
  Elite <- as.factor(Elite)
  college <- data.frame(college, Elite)
  
  summary(college)
  
  college |>
    ggplot(aes(x = factor(Elite), y = Outstate)) +
    geom_boxplot() +
    labs(title = "Out-of-State Tuition vs Elite College",
         x = "Elite College",
         y = "Out-of-State tuintion") +
    theme_bw()
```

There are 78 elite colleges. The grouped box plot of out-of-state tuition grouped by elite college status shows every statistic in the five number summary as higher for the elite colleges.

# Question 1.C.v
```{r}
  par(mfrow = c(2,2))
  bins = c(10, 15, 20, 25)
  for (bin in bins) {
    hist(college$Outstate, 
         breaks = bin, 
         main = paste("Histogram of Out-of-State Tuition with", bin, "bins"),
         xlab = "Out-of-State Tuition",
         col = "lightblue",
         border = "black")
  }
```

We see the out of state tuition is slightly right skewed, centered at 9990 dollars, and has an IQR of 5605.

# Question 1,C.vi
```{r}
  # exploring the relation ship between grad rate and s.f.ratio
  college |>
    ggplot(aes(S.F.Ratio,Grad.Rate)) +
    geom_point() +
    labs(title = "Graduation Rate vs Student-Faculty Ratio",
         x = "Student-Faculty Ratio",
         y = "Graduation Rate") +
    theme_bw()

  # randomly sample half the data to meet the assumption of linear regression
  set.seed(100)
  collegeSample <- 
    college |> sample_n(nrow(college)/2)

  # run a linear model to see the relationship
  model <- 
    lm(Grad.Rate ~ S.F.Ratio, data = collegeSample)

  # check residuals
  plot(model)

  # The residuals appear to be linear, normal, and equally spread out; thus, the assumptions of linear regression are met.
  summary(model)
    
```

From a linear regression test, we found the assumption to be met and a significant negative relationship between Graduation Rate and Student-Faculty Ratio (t = -1.25, p-value < 0.001, df = 386). This suggests a higher student-faculty ratio is associated with a lower graduation rate. The overall model was statistically significant (F = 15.63, p-value < 0.001, df = 386) but explained approximately 9.4% of the variance in graduation rates (Adjusted R-squared: 0.094). Therefore, while there is a significant relationship, the effect size is small.

# Question 2.A
```{r}
  # read csv
  Auto <- read.csv("Data/Auto.csv")
  Auto <- as_tibble(Auto)

  # drop missing data
  Auto <- na.omit(Auto)
  Auto <- Auto[Auto$horsepower != "?", ]
  
  # set qualitative variables to character dtypes and quantitative variable to numeric dtypes.
  Auto$horsepower <- as.numeric(Auto$horsepower)
  Auto$origin <- as.character(Auto$origin)
  Auto$cylinders <- as.character(Auto$cylinders)
  Auto$year <- as.character(Auto$year)
  
  # part a
  quantitative_vars <- Auto |>
    select_if(is.numeric)
  print(names(quantitative_vars))
  
  qualitative_vars <- Auto |>
    select_if(is.character)
  print(names(qualitative_vars))
```

Here I read in the data, dropped the missing data, and set a standard of data type for the two groups of variables. Notably, I included the year the car was made as a qualitative variable since in this analysis it is treated as a label rather than a predictor. 

# Question 2.B
```{r}
  # part b
  for ( var in names(quantitative_vars) ){
    var_range <- Auto |> 
      select(any_of(var)) |> range()
    print( paste( paste("Range of", var), toString(var_range) ) )
  }
```

Here we see the range of each quantitative variable. The first number is the minimum and and the second number is the maximum. This is including outliers.

# Question 2.C
```{r}
  # part c
  n_quantitative <- ncol(quantitative_vars)
  
    # loop through each quantitative variable and print the standard deviation and mean
  for ( i in seq(1,n_quantitative) ) {
    var <- as.data.frame(quantitative_vars)[,i]
    sd_var <- sd(var)
    mean_var <- mean(var)
    name <- colnames(quantitative_vars)[i] 
    print(name)
    print(paste("Standard Deviation:", sd_var))
    print(paste("Mean:", sd_var))
    print("---------------------------------")
  }
```

# Question 2.D
```{r}
  # part d
  AutoSlice <- as.data.frame(Auto)[10:85, ]

  quantitative_vars_slice <- AutoSlice |>
    select_if(is.numeric)
  
  # loop through each quantitative variable and print the standard deviation, mean, and range
  for ( i in seq(1,n_quantitative) ) {
    var <- quantitative_vars_slice[,i]
    sd_var <- sd(var)
    mean_var <- mean(var)
    range_var <- range(var)
    name <- colnames(quantitative_vars_slice)[i] 
    print(name)
    print(paste("Standard Deviation:", sd_var))
    print(paste("Mean:", mean_var))
    print(paste("Range:", toString(range_var)))
    print("------------------------------------------")
  }
```

# Question 2.E
```{r}
  # part e
  
  # create a scatterplot matrix for each pair of quantitative variables lableled by each qualitative variable
  pairs(quantitative_vars, 
        col = as.numeric(qualitative_vars$origin),
        main = "Scatterplot Matrix of Quantitative Variables Colored by Origin")

  pairs(quantitative_vars,
        col = as.numeric(qualitative_vars$cylinders),
        main = "Scatterplot Matrix of Quantitative Variables Colored by Cylinders")
  
  pairs(quantitative_vars,
        col = as.numeric(qualitative_vars$year),
        main = "Scatterplot Matrix of Quantitative Variables Colored by Year")

```

From the scatter plot matrices, it appears that the number of cylinders nicely groups the data points for several pairs of quantitative variables, such as horsepower vs. mpg and weight vs. mpg. The origin variable also shows some grouping, particularly for displacement vs. mpg. The year variable does not seem to create distinct groupings in the scatter plots. There are clearly some non-linear relationships present, such as between horsepower and mpg, which shows a curved pattern rather than a straight line. However, there are many clean linear relationships as well, such as between weight and mpg.

# Question 2.F
Variables that appear to be strongly correlated with mpg include weight, displacement, and horsepower. Each scatterplot between mpg and these variables show tightly grouped data points suggesting they are strongly related and useful predictors.

# Question 3.A
```{R}
  library(ISLR2)

  n_rows <- nrow(Boston)
  n_cols <- ncol(Boston)
  
  print(paste("Number of rows:", n_rows))
  print(paste("Number of columns:", n_cols))
  
```

The Boston data set has 506 rows and 14 columns. Each represents the suburbs of Boston with various attributes such as crime rate, average number of rooms per dwelling, and median value of owner-occupied homes.

# Question 3.B
```{r}
  # use pairs to create a scatter plot matrix but split it into two parts to improve readability
  pairs(Boston[, 1:7])
  pairs(Boston[, 8:13])
  pairs(Boston)
  
  # the relationship between nox and zn appears to be non-linear
  Boston |>
      ggplot(aes(nox,zn)) +
      geom_point() +
      labs() +
      theme_bw()
  
  # the relationship between crime rate and average number of rooms per dwelling appears to be non-linear
  Boston |>
      ggplot(aes(crim,rm)) +
      geom_point() +
      labs() +
      theme_bw()
  
  # apply log transformation to crim and rm to see if the relationship becomes more linear
  Boston |>
      mutate(tranf_crim = log(crim), tranf_rm = log(rm)) |>
      ggplot(aes(tranf_crim,tranf_rm)) +
      geom_point() +
      labs() +
      theme_bw()
```

There are several non linear relationships present in the scatter plot matrix. For example, the relationship between nox and zn appears to be non-linear. Similarly, the relationship between crim and rm also appears to be non-linear. After applying a log transformation to both variables, the relationship between crim and rm appears to be more linear.

# Question 3.C

It appears that the log of crime and the log of average number of rooms per dwelling have a negative linear relationship. That is, as the log of crime increases, the log of average number of rooms per dwelling decreases.

```{r}
  Boston |>
      mutate(tranf_crim = log(crim), tranf_rm = log(rm)) |>
      ggplot(aes(tranf_crim,tranf_rm)) +
      geom_point() +
      labs() +
      theme_bw()

  Boston <- Boston |>
      mutate(tranf_crim = log(crim), tranf_rm = log(rm))

  # randomly sample half the data to meet the assumption of linear regression
  set.seed(100)
  BostonSample <- 
    Boston |> sample_n(nrow(Boston)/2)

  # run a linear model to see the relationship
  model <- 
    lm(tranf_crim ~ tranf_rm, data = Boston)

  # check residuals
  plot(model)

  # normality assumptions not met
```

The QQ residuals plot of a linear model suggests the residuals are not normally distributed, thus we fail to meet the assumptions of a linear regression test. Therefore, we can not conclude that there is a significant linear relationship between the log of crime and the log of average number of rooms per dwelling.

# Question 3.D
```{r}
  range(Boston$tax)
  range(Boston$crim)
  range(Boston$ptratio)
```

The range of the crime rate per capita is immensely larger than the ranges of both the property tax rate and pupil-teacher ratio. The range of crime rate is 88.9762 (0.00632 to 88.9830), while the range of property tax rate is 666 (187 to 853) and the range of pupil-teacher ratio is 20.2 (12.6 to 22.0). This suggest that some suburbs have extremely high crime rates compared to others, while the property tax rate and pupil-teacher ratio are more consistent across suburbs. That being said, the property tax rate still has a fairly large range compared to the pupil-teacher ratio.

# Question 3.E
```{r}
  bound <- Boston[Boston["chas"] == 1,]
  print(paste("Number of suburbs that bound the Charles river:",nrow(bound)))
```

# Question 3.F
```{r}
  median_ptratio <- median(Boston$ptratio)
  print(paste("Median pupil-teacher ratio:", median_ptratio))
```














